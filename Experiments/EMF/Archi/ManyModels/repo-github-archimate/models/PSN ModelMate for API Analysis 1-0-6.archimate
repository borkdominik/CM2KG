<?xml version="1.0" encoding="UTF-8"?>
<archimate:model xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:archimate="http://www.archimatetool.com/archimate" name="PSN ModelMate for API Analysis" id="60bd15bf" version="3.1.1">
  <folder name="Business" id="a1e4f55a" type="business"/>
  <folder name="Application" id="65faa5d1" type="application">
    <folder name="Applications" id="e1968911">
      <folder name="ApplicationComponent" id="f5cd151e">
        <element xsi:type="archimate:ApplicationComponent" id="208c7762" name="VetContext1.TestWinForms1.exe"/>
        <element xsi:type="archimate:ApplicationComponent" id="7a213639" name="VetContextHelper.dll"/>
      </folder>
      <folder name="ApplicationInterface" id="78f16551">
        <element xsi:type="archimate:ApplicationInterface" id="899c17c6" name="VetContext1.Helpers"/>
        <element xsi:type="archimate:ApplicationInterface" id="23804f16" name="VetContext1.TestWinForms1.MainForm1"/>
        <element xsi:type="archimate:ApplicationInterface" id="bf6ec06a" name="VetContext1.TestWinForms1.NewPatientForm"/>
        <element xsi:type="archimate:ApplicationInterface" id="3026ff95" name="VetContext1.TestWinForms1.Program"/>
      </folder>
    </folder>
    <element xsi:type="archimate:ApplicationComponent" id="df39801b" name="Application Component"/>
    <element xsi:type="archimate:ApplicationInterface" id="5e100dcd" name="Application Interface"/>
    <element xsi:type="archimate:ApplicationFunction" id="4c71f639" name="Application Function"/>
    <element xsi:type="archimate:DataObject" id="a0f4734c" name="Data Object"/>
    <element xsi:type="archimate:ApplicationService" id="718159d0" name="Application Service"/>
    <element xsi:type="archimate:ApplicationInterface" id="df120d4b" name="Application Interface"/>
  </folder>
  <folder name="Technology" id="86ef6029" type="technology">
    <folder name="InfrastructureInterface" id="ef30e72c">
      <element xsi:type="archimate:InfrastructureInterface" id="619c352e" name="System.Data.Entity.Utilities.ByteExtensions"/>
    </folder>
    <folder name="SystemSoftware" id="0637ec2f">
      <element xsi:type="archimate:SystemSoftware" id="cb4c73fc" name="EntityFramework.dll"/>
      <element xsi:type="archimate:SystemSoftware" id="cd247a08" name="mscorlib.dll"/>
    </folder>
    <folder name="Artifacts" id="aac06c23">
      <documentation>Physical Files&#xD;
</documentation>
      <element xsi:type="archimate:Artifact" id="c6109bf3" name="EntityFramework.dll"/>
      <element xsi:type="archimate:Artifact" id="6bb4e7ef" name="mscorlib.dll"/>
      <element xsi:type="archimate:Artifact" id="bf5a75bb" name="VetContext1.TestWinForms1.exe"/>
      <element xsi:type="archimate:Artifact" id="6a431902" name="VetContextHelper.dll"/>
    </folder>
    <element xsi:type="archimate:Artifact" id="9c88897c" name="System.Data.dll"/>
    <element xsi:type="archimate:Artifact" id="bc216ad8" name="File (.exe or .dll)"/>
    <element xsi:type="archimate:Artifact" id="7ba8856c" name="MethodDefinition (ctors &amp; methods)"/>
    <element xsi:type="archimate:Artifact" id="f5d11a99" name="CilWorker"/>
    <element xsi:type="archimate:Artifact" id="53cd0dc7" name="Instructions"/>
    <element xsi:type="archimate:Artifact" id="dd75be03" name="AssemblyDefinition"/>
    <element xsi:type="archimate:Artifact" id="1bf0f3be" name="ModuleDefinition (MainModule)"/>
    <element xsi:type="archimate:Artifact" id="f5b54d05" name="TypeDefinition"/>
    <element xsi:type="archimate:Artifact" id="205040a8" name="Types"/>
    <element xsi:type="archimate:Artifact" id="bb846386" name="Body"/>
    <element xsi:type="archimate:Artifact" id="6213384b" name="FieldDefinition"/>
    <element xsi:type="archimate:Artifact" id="2a1db38c" name="PropertyDefinition"/>
    <element xsi:type="archimate:Artifact" id="d2e2e609" name="Methods, Constructors"/>
    <element xsi:type="archimate:Artifact" id="8ca64896" name="Fields"/>
    <element xsi:type="archimate:Artifact" id="97f41098" name="Properties"/>
    <element xsi:type="archimate:Artifact" id="bb2697a4" name="AssemblyReferences"/>
    <element xsi:type="archimate:Artifact" id="9c8e95d8" name="Instruction"/>
    <element xsi:type="archimate:Artifact" id="51c4570e" name="Instruction (instruction.OpCode == OpCodes.Call)"/>
    <element xsi:type="archimate:Artifact" id="3238bb02" name="MethodReference"/>
    <element xsi:type="archimate:Artifact" id="7f30b0ad" name="Instruction (instruction.OpCode == OpCodes.Ldfld)"/>
    <element xsi:type="archimate:Artifact" id="5960c797" name="FieldReference"/>
    <element xsi:type="archimate:Artifact" id="df853636" name="ReturnType (e.g. System.Void)"/>
    <element xsi:type="archimate:Artifact" id="d046beea" name="Artifact"/>
    <element xsi:type="archimate:SystemSoftware" id="89291244" name="System Software"/>
    <element xsi:type="archimate:InfrastructureFunction" id="45fc24a1" name="Infrastructure Function"/>
    <element xsi:type="archimate:InfrastructureInterface" id="14a56e98" name="Infrastructure Interface"/>
    <element xsi:type="archimate:InfrastructureService" id="7f01bbd5" name="Infrastructure Service"/>
    <element xsi:type="archimate:InfrastructureInterface" id="e5e64e57" name="Infrastructure Interface"/>
  </folder>
  <folder name="Motivation" id="1f0c25e3" type="motivation"/>
  <folder name="Implementation &amp; Migration" id="83d1430e" type="implementation_migration"/>
  <folder name="Connectors" id="b86a97b1" type="connectors"/>
  <folder name="Relations" id="59288de5" type="relations">
    <element xsi:type="archimate:UsedByRelationship" id="6db01ebf" name="Implements Interface" source="619c352e" target="cb4c73fc"/>
    <element xsi:type="archimate:UsedByRelationship" id="5c0b4cad" name="System.Void Foo1(String)" source="619c352e" target="bf6ec06a"/>
    <element xsi:type="archimate:UsedByRelationship" id="2a3f207f" name="Implements Interface" source="23804f16" target="208c7762"/>
    <element xsi:type="archimate:UsedByRelationship" id="67712dd2" name="Implements Interface" source="3026ff95" target="208c7762"/>
    <element xsi:type="archimate:UsedByRelationship" id="f2c54739" name="Implements Interface" source="bf6ec06a" target="208c7762"/>
    <element xsi:type="archimate:UsedByRelationship" id="55349e38" name="Implements Interface" source="899c17c6" target="7a213639"/>
    <element xsi:type="archimate:UsedByRelationship" id="283c5f09" name="References Assembly" source="cb4c73fc" target="208c7762"/>
    <element xsi:type="archimate:UsedByRelationship" id="b8850043" name="References Assembly" source="7a213639" target="208c7762"/>
    <element xsi:type="archimate:UsedByRelationship" id="ed158ea0" name="References Assembly" source="cd247a08" target="cb4c73fc"/>
    <element xsi:type="archimate:RealisationRelationship" id="461df286" source="c6109bf3" target="cb4c73fc"/>
    <element xsi:type="archimate:RealisationRelationship" id="34ee475a" source="6bb4e7ef" target="cd247a08"/>
    <element xsi:type="archimate:RealisationRelationship" id="ad353354" source="bf5a75bb" target="208c7762"/>
    <element xsi:type="archimate:RealisationRelationship" id="496136cb" source="6a431902" target="7a213639"/>
    <element xsi:type="archimate:RealisationRelationship" id="1a928853" source="9c88897c" target="619c352e"/>
    <element xsi:type="archimate:AssociationRelationship" id="7d360b96" name="ReadModule" source="bc216ad8" target="1bf0f3be"/>
    <element xsi:type="archimate:AggregationRelationship" id="608d8467" name="1" source="d2e2e609" target="7ba8856c"/>
    <element xsi:type="archimate:AssociationRelationship" id="6ee86b94" name="ReadAssembly" source="bc216ad8" target="dd75be03"/>
    <element xsi:type="archimate:AssociationRelationship" id="63f9f159" source="1bf0f3be" target="205040a8"/>
    <element xsi:type="archimate:AggregationRelationship" id="1b9a49e8" source="205040a8" target="f5b54d05"/>
    <element xsi:type="archimate:AssociationRelationship" id="7b706ee2" source="bb846386" target="f5d11a99"/>
    <element xsi:type="archimate:AssociationRelationship" id="404c005c" source="7ba8856c" target="bb846386"/>
    <element xsi:type="archimate:AssociationRelationship" id="54fbda4e" source="bb846386" target="53cd0dc7"/>
    <element xsi:type="archimate:AggregationRelationship" id="d55845eb" source="8ca64896" target="6213384b"/>
    <element xsi:type="archimate:AggregationRelationship" id="dbea7ee9" source="97f41098" target="2a1db38c"/>
    <element xsi:type="archimate:AssociationRelationship" id="94f1e1c3" source="f5b54d05" target="d2e2e609"/>
    <element xsi:type="archimate:AggregationRelationship" id="21837b00" name="SetMethod, GetMethod" source="2a1db38c" target="7ba8856c"/>
    <element xsi:type="archimate:AssociationRelationship" id="eb15c67b" source="f5b54d05" target="8ca64896"/>
    <element xsi:type="archimate:AssociationRelationship" id="f24ca19d" source="f5b54d05" target="97f41098"/>
    <element xsi:type="archimate:AssociationRelationship" id="b382bd78" source="1bf0f3be" target="bb2697a4"/>
    <element xsi:type="archimate:AggregationRelationship" id="ffa65782" source="53cd0dc7" target="9c8e95d8"/>
    <element xsi:type="archimate:AssociationRelationship" id="22d3799d" source="9c8e95d8" target="51c4570e"/>
    <element xsi:type="archimate:AssociationRelationship" id="f259f122" source="51c4570e" target="3238bb02"/>
    <element xsi:type="archimate:AssociationRelationship" id="c5bc7b59" source="7f30b0ad" target="5960c797"/>
    <element xsi:type="archimate:AssociationRelationship" id="2fb87559" source="9c8e95d8" target="7f30b0ad"/>
    <element xsi:type="archimate:AssociationRelationship" id="9088624e" source="dd75be03" target="1bf0f3be"/>
    <element xsi:type="archimate:AssociationRelationship" id="c76e6047" source="6213384b" target="a0f4734c"/>
    <element xsi:type="archimate:AssociationRelationship" id="3f87435f" source="5960c797" target="a0f4734c"/>
    <element xsi:type="archimate:AssociationRelationship" id="1ab8a888" source="bc216ad8" target="d046beea"/>
    <element xsi:type="archimate:AssociationRelationship" id="9d0d4ec7" source="3238bb02" target="e5e64e57"/>
    <element xsi:type="archimate:AssociationRelationship" id="fcad7b7f" source="1bf0f3be" target="4c71f639"/>
    <element xsi:type="archimate:AssociationRelationship" id="df1a6376" source="1bf0f3be" target="45fc24a1"/>
    <element xsi:type="archimate:AssociationRelationship" id="e9daafe0" source="f5b54d05" target="7f01bbd5"/>
    <element xsi:type="archimate:AssociationRelationship" id="d7b3db05" source="f5b54d05" target="718159d0"/>
    <element xsi:type="archimate:AssociationRelationship" id="8e61a519" source="df853636" target="14a56e98"/>
    <element xsi:type="archimate:AssociationRelationship" id="b177fb86" source="df853636" target="5e100dcd"/>
    <element xsi:type="archimate:AssociationRelationship" id="619d7e21" source="7ba8856c" target="14a56e98"/>
    <element xsi:type="archimate:AssociationRelationship" id="73e76e72" source="7ba8856c" target="5e100dcd"/>
    <element xsi:type="archimate:RealisationRelationship" id="121ffd67" name="Realization" source="d046beea" target="df39801b"/>
    <element xsi:type="archimate:RealisationRelationship" id="846a612a" name="Realizes" source="d046beea" target="89291244"/>
    <element xsi:type="archimate:AssociationRelationship" id="126d1196" source="3238bb02" target="df120d4b"/>
    <element xsi:type="archimate:UsedByRelationship" id="18ba669d" name="Used by" source="89291244" target="45fc24a1"/>
    <element xsi:type="archimate:UsedByRelationship" id="84dfd505" name="Used by" source="df39801b" target="4c71f639"/>
    <element xsi:type="archimate:RealisationRelationship" id="6052fa43" name="Realizes" source="45fc24a1" target="7f01bbd5"/>
    <element xsi:type="archimate:RealisationRelationship" id="650c1f7e" name="Realizes" source="4c71f639" target="718159d0"/>
    <element xsi:type="archimate:AssociationRelationship" id="92172e54" source="dd75be03" target="df39801b"/>
    <element xsi:type="archimate:AssociationRelationship" id="b7120d96" source="dd75be03" target="89291244"/>
    <element xsi:type="archimate:AssociationRelationship" id="f62a0232" name="Associated with" source="718159d0" target="14a56e98"/>
    <element xsi:type="archimate:AssociationRelationship" id="0385abfe" name="Associated with" source="7f01bbd5" target="5e100dcd"/>
    <element xsi:type="archimate:AssociationRelationship" id="7d7f96e6" source="4c71f639" target="df39801b"/>
    <element xsi:type="archimate:AssociationRelationship" id="3a5d2a75" source="bb2697a4" target="df39801b"/>
    <element xsi:type="archimate:AssociationRelationship" id="7a1b7441" source="bb2697a4" target="89291244"/>
    <element xsi:type="archimate:AssociationRelationship" id="f70383f8" source="45fc24a1" target="89291244"/>
    <element xsi:type="archimate:TriggeringRelationship" id="b26e1873" name="Calls" source="e5e64e57" target="14a56e98"/>
    <element xsi:type="archimate:TriggeringRelationship" id="7285e3a5" name="Calls" source="df120d4b" target="5e100dcd"/>
  </folder>
  <folder name="Views" id="6a3e4479" type="diagrams">
    <element xsi:type="archimate:ArchimateDiagramModel" id="900060fa" name="ModelMateSample1">
      <child xsi:type="archimate:Group" id="91d2dee8" name="System.Data namespace" fillColor="#ecf7e6">
        <bounds x="36" y="60" width="400" height="308"/>
        <child xsi:type="archimate:DiagramObject" id="4673661e" textAlignment="2" targetConnections="6fd21141" archimateElement="619c352e">
          <bounds x="132" y="108" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="1cbe4247" source="4673661e" target="f2a08241" relationship="5c0b4cad"/>
          <sourceConnection xsi:type="archimate:Connection" id="6bf678da" source="4673661e" target="0851f93a" relationship="6db01ebf"/>
        </child>
      </child>
      <child xsi:type="archimate:Group" id="5922abd2" name="Microsoft .NET Runtime Assemblies" fillColor="#ecf7e6">
        <bounds x="36" y="396" width="400" height="140"/>
        <child xsi:type="archimate:DiagramObject" id="0851f93a" textAlignment="2" targetConnections="6bf678da 4f8bac06 0cbf2be6" archimateElement="cb4c73fc">
          <bounds x="24" y="36" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="897df62c" source="0851f93a" target="b9070aea" relationship="283c5f09"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="a5cc7e69" textAlignment="2" targetConnections="78049e29" archimateElement="cd247a08">
          <bounds x="264" y="72" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="4f8bac06" source="a5cc7e69" target="0851f93a" relationship="ed158ea0"/>
        </child>
      </child>
      <child xsi:type="archimate:Group" id="f1efd4e1" name="VetContext1.TestWinForms1 namespace" fillColor="#ddffff">
        <bounds x="468" y="60" width="409" height="308"/>
        <child xsi:type="archimate:DiagramObject" id="c06a8a68" textAlignment="2" archimateElement="23804f16">
          <bounds x="145" y="168" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="6b272c52" source="c06a8a68" target="b9070aea" relationship="2a3f207f"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="91fac3a8" textAlignment="2" archimateElement="3026ff95">
          <bounds x="12" y="228" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="15806773" source="91fac3a8" target="b9070aea" relationship="67712dd2"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="f2a08241" textAlignment="2" targetConnections="1cbe4247" archimateElement="bf6ec06a">
          <bounds x="276" y="108" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="ca9a7d92" source="f2a08241" target="b9070aea" relationship="f2c54739"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="527589d2" textAlignment="2" archimateElement="899c17c6">
          <bounds x="276" y="228" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="57d405d9" source="527589d2" target="cb0f9d2a" relationship="55349e38"/>
        </child>
      </child>
      <child xsi:type="archimate:Group" id="21dded2a" name="Application Assemblies" fillColor="#ddffff">
        <bounds x="468" y="396" width="409" height="140"/>
        <child xsi:type="archimate:DiagramObject" id="b9070aea" textAlignment="2" targetConnections="6b272c52 15806773 ca9a7d92 897df62c 83b17223 75259d60" archimateElement="208c7762" type="1">
          <bounds x="12" y="36" width="120" height="55"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="cb0f9d2a" textAlignment="2" targetConnections="57d405d9 951cce88" archimateElement="7a213639" type="1">
          <bounds x="276" y="36" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="83b17223" source="cb0f9d2a" target="b9070aea" relationship="b8850043"/>
        </child>
      </child>
      <child xsi:type="archimate:Note" id="845f540e" textAlignment="1">
        <bounds x="36" y="744" width="517" height="97"/>
        <content>Entities&#xD;
&#xD;
Fully Qualified Namespace = Application Interface&#xD;
Two-Level Namespace = Group&#xD;
Assembly (DLL, EXE, or referenced assembly) = Application Component or System Software</content>
      </child>
      <child xsi:type="archimate:Note" id="dd8fa1ed" textAlignment="1">
        <bounds x="600" y="744" width="469" height="97"/>
        <content>Relationships&#xD;
&#xD;
Interface-Interface: Method signature (Used By)&#xD;
Interface-Application Component: &quot;Implements Interface&quot; (Used By)&#xD;
Appliction Component-Application Component: &quot;References Assembly&quot; (Used By)&#xD;
</content>
      </child>
      <child xsi:type="archimate:Group" id="576e484f" name="Other.ThirdParty Assemblies" fillColor="#ddffff">
        <bounds x="900" y="396" width="400" height="140"/>
      </child>
      <child xsi:type="archimate:Group" id="f790a2bd" name="Other.ThirdParty namespace" fillColor="#ddffff">
        <bounds x="900" y="60" width="400" height="308"/>
      </child>
      <child xsi:type="archimate:Group" id="b154110b" name="Artifacts (Physical Files)" fillColor="#ecf7e6">
        <bounds x="36" y="564" width="1264" height="169"/>
        <child xsi:type="archimate:DiagramObject" id="c3c6301b" textAlignment="2" archimateElement="c6109bf3">
          <bounds x="24" y="36" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="0cbf2be6" source="c3c6301b" target="0851f93a" relationship="461df286"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="d9ba26ba" textAlignment="2" archimateElement="6bb4e7ef">
          <bounds x="264" y="36" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="78049e29" source="d9ba26ba" target="a5cc7e69" relationship="34ee475a"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="7d417f48" textAlignment="2" archimateElement="bf5a75bb">
          <bounds x="444" y="36" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="75259d60" source="7d417f48" target="b9070aea" relationship="ad353354"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="4cbc0e7d" textAlignment="2" archimateElement="6a431902">
          <bounds x="708" y="36" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="951cce88" source="4cbc0e7d" target="cb0f9d2a" relationship="496136cb"/>
        </child>
        <child xsi:type="archimate:DiagramObject" id="93ebc04c" textAlignment="2" archimateElement="9c88897c">
          <bounds x="143" y="96" width="120" height="55"/>
          <sourceConnection xsi:type="archimate:Connection" id="6fd21141" source="93ebc04c" target="4673661e" relationship="1a928853"/>
        </child>
      </child>
    </element>
    <element xsi:type="archimate:ArchimateDiagramModel" id="015ee199" name="Cecil OM">
      <child xsi:type="archimate:DiagramObject" id="2a5d05be" textAlignment="2" fillColor="#9fd580" archimateElement="bc216ad8">
        <bounds x="24" y="24" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="868e6c3f" source="2a5d05be" target="bc21b8ea" relationship="6ee86b94"/>
        <sourceConnection xsi:type="archimate:Connection" id="f240e054" source="2a5d05be" target="80809ee7" relationship="7d360b96"/>
        <sourceConnection xsi:type="archimate:Connection" id="4160badc" source="2a5d05be" target="c14c2d08" relationship="1ab8a888"/>
      </child>
      <child xsi:type="archimate:Note" id="3e66bb99" font="1|Segoe UI|7.8|0|WINDOWS|1|-13|0|0|0|400|0|0|0|0|3|2|1|34|Segoe UI" textAlignment="1">
        <bounds x="732" y="24" width="613" height="967"/>
        <content>Console.WriteLine (&quot;Code added in &quot;, method.Name);&#xD;
The first thing to do is getting the System.Reflection.MethodInfo which correspond to the Console.WriteLine (string value) method.&#xD;
&#xD;
//Gets the MethodInfo of Console.WriteLine() method&#xD;
MethodInfo writeLineMethod = typeof(Console).GetMethod(&quot;WriteLine&quot;, new Type[]{typeof(string)});&#xD;
Next, you have to get all methods of each type of the MyLibrary assembly in order to insert the MSIL instructions.&#xD;
&#xD;
//Getting the path of the &quot;MyLibrary.dll&quot; assembly&#xD;
string pathBin = &quot;../../../MyLibrary/bin/debug/MyLibrary.dll&quot;;&#xD;
 &#xD;
//Gets the AssemblyDefinition of &quot;MyLibrary&quot;&#xD;
AssemblyDefinition assembly = AssemblyDefinition.ReadAssembly(pathBin);&#xD;
 &#xD;
//Gets all types of the MainModule of the assembly&#xD;
foreach(TypeDefinition type in assembly.MainModule.Types)&#xD;
{&#xD;
    if(type.Name != &quot;&lt;Module>&quot;)&#xD;
    {&#xD;
        //Gets all methods of the current type&#xD;
        foreach(MethodDefinition method in type.Methods)&#xD;
        {&#xD;
            //Gets the CilWorker of the method for working with CIL instructions&#xD;
            CilWorker worker = method.Body.CilWorker;&#xD;
 &#xD;
            //Creating a sentence according to the current method&#xD;
            string sentence;&#xD;
            sentence = String.Concat(&quot;Code added in &quot;, method.Name);&#xD;
 &#xD;
            //Import the Console.WriteLine() method&#xD;
            MethodReference writeLine;&#xD;
            writeLine = assembly.MainModule.Import(writeLineMethod);&#xD;
 &#xD;
            //Creates the MSIL instruction for inserting the sentence&#xD;
            Instruction insertSentence;&#xD;
            insertSentence = worker.Create(OpCodes.Ldstr, sentence);&#xD;
 &#xD;
            //Creates the CIL instruction for calling the&#xD;
            //Console.WriteLine(string value) method&#xD;
            Instruction callWriteLine;&#xD;
            callWriteLine = worker.Create(OpCodes.Call, writeLine);&#xD;
 &#xD;
 &#xD;
            //Getting the first instruction of the current method&#xD;
            Instruction ins = method.Body.Instructions[0];&#xD;
 &#xD;
            //Inserts the insertSentence instruction before the first //instruction&#xD;
            method.Body.CilWorker.InsertBefore(ins, insertSentence);&#xD;
 &#xD;
            //Inserts the callWriteLineMethod after the //insertSentence instruction&#xD;
            worker.InsertAfter(insertSentence, callWriteLine);&#xD;
        }&#xD;
    }&#xD;
}&#xD;
The last thing to do is saving the assembly which contains the modifying types:&#xD;
&#xD;
//Save the modified &quot;MyLibrary&quot; assembly&#xD;
assembly.Write(pathBin);&#xD;
After executing this code, you can use the modifying assembly in a new Console project. You have to add a reference to this assembly.&#xD;
&#xD;
MyLibrary.Person p = new MyLibrary.Person();&#xD;
p.Name = &quot;Harry May&quot;;&#xD;
p.Birthday = new DateTime(1982, 01, 26);&#xD;
int age = p.GetAge();&#xD;
Console.ReadLine();&#xD;
This code produces also this result:&#xD;
&#xD;
set_Name was called&#xD;
set_Birthday was called&#xD;
GetAge was called</content>
      </child>
      <child xsi:type="archimate:DiagramObject" id="2dc04bc5" textAlignment="2" targetConnections="b02bea1c 22caa38d" fillColor="#9fd580" archimateElement="7ba8856c">
        <bounds x="216" y="504" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="755f96de" source="2dc04bc5" target="61620bcc" relationship="404c005c"/>
        <sourceConnection xsi:type="archimate:Connection" id="7f216996" source="2dc04bc5" target="192f55d2" relationship="619d7e21"/>
        <sourceConnection xsi:type="archimate:Connection" id="9431dacd" source="2dc04bc5" target="90f40a81" relationship="73e76e72"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="e486dc5d" textAlignment="2" targetConnections="2f126dd9" archimateElement="f5d11a99">
        <bounds x="144" y="696" width="120" height="55"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="c0a522ac" textAlignment="2" targetConnections="7b30da37" archimateElement="53cd0dc7">
        <bounds x="288" y="696" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="f9ba398b" source="c0a522ac" target="aefe076e" relationship="ffa65782"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="bc21b8ea" textAlignment="2" targetConnections="868e6c3f" archimateElement="dd75be03">
        <bounds x="216" y="24" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="390f79ff" source="bc21b8ea" target="80809ee7" relationship="9088624e"/>
        <sourceConnection xsi:type="archimate:Connection" id="fa292b05" source="bc21b8ea" target="1e6fec85" relationship="92172e54"/>
        <sourceConnection xsi:type="archimate:Connection" id="52a0bb96" source="bc21b8ea" target="6963081f" relationship="b7120d96"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="80809ee7" textAlignment="2" targetConnections="f240e054 390f79ff" fillColor="#9fd580" archimateElement="1bf0f3be">
        <bounds x="216" y="120" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="4d9627d6" source="80809ee7" target="eda177ce" relationship="63f9f159"/>
        <sourceConnection xsi:type="archimate:Connection" id="1f8fa68b" source="80809ee7" target="7fd1e922" relationship="b382bd78"/>
        <sourceConnection xsi:type="archimate:Connection" id="fdaa5ed4" source="80809ee7" target="7d8ac667" relationship="fcad7b7f"/>
        <sourceConnection xsi:type="archimate:Connection" id="9d7a204f" source="80809ee7" target="2a2dc6d8" relationship="df1a6376"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="f46b9257" textAlignment="2" targetConnections="244a0da5" fillColor="#9fd580" archimateElement="f5b54d05">
        <bounds x="24" y="312" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="c81038ff" source="f46b9257" target="4456734d" relationship="94f1e1c3"/>
        <sourceConnection xsi:type="archimate:Connection" id="4398c4a6" source="f46b9257" target="e2d39216" relationship="eb15c67b"/>
        <sourceConnection xsi:type="archimate:Connection" id="bbbcc0c1" source="f46b9257" target="36f1dcff" relationship="f24ca19d"/>
        <sourceConnection xsi:type="archimate:Connection" id="a95ef26b" source="f46b9257" target="e8258cf4" relationship="e9daafe0"/>
        <sourceConnection xsi:type="archimate:Connection" id="940e08cd" source="f46b9257" target="49655a8c" relationship="d7b3db05"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="eda177ce" textAlignment="2" targetConnections="4d9627d6" archimateElement="205040a8">
        <bounds x="24" y="216" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="244a0da5" source="eda177ce" target="f46b9257" relationship="1b9a49e8"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="61620bcc" textAlignment="2" targetConnections="755f96de" archimateElement="bb846386">
        <bounds x="216" y="600" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="7b30da37" source="61620bcc" target="c0a522ac" relationship="54fbda4e"/>
        <sourceConnection xsi:type="archimate:Connection" id="2f126dd9" source="61620bcc" target="e486dc5d" relationship="7b706ee2"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="480c277e" textAlignment="2" targetConnections="32b17853" fillColor="#9fd580" archimateElement="6213384b">
        <bounds x="24" y="504" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="2b4b3f96" source="480c277e" target="3e5fd50c" relationship="c76e6047"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="56b6dbf0" textAlignment="2" targetConnections="c77fe05e" archimateElement="2a1db38c">
        <bounds x="564" y="504" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="22caa38d" source="56b6dbf0" target="2dc04bc5" relationship="21837b00"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="4456734d" textAlignment="2" targetConnections="c81038ff" archimateElement="d2e2e609">
        <bounds x="216" y="408" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="b02bea1c" source="4456734d" target="2dc04bc5" relationship="608d8467"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="e2d39216" textAlignment="2" targetConnections="4398c4a6" archimateElement="8ca64896">
        <bounds x="24" y="408" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="32b17853" source="e2d39216" target="480c277e" relationship="d55845eb"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="36f1dcff" textAlignment="2" targetConnections="bbbcc0c1" archimateElement="97f41098">
        <bounds x="384" y="408" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="c77fe05e" source="36f1dcff" target="56b6dbf0" relationship="dbea7ee9"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="7fd1e922" textAlignment="2" targetConnections="1f8fa68b" archimateElement="bb2697a4">
        <bounds x="468" y="132" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="d97c5904" source="7fd1e922" target="6963081f" relationship="7a1b7441"/>
        <sourceConnection xsi:type="archimate:Connection" id="560ec4e0" source="7fd1e922" target="1e6fec85" relationship="3a5d2a75"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="aefe076e" textAlignment="2" targetConnections="f9ba398b" archimateElement="9c8e95d8">
        <bounds x="288" y="792" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="84d98d98" source="aefe076e" target="0a5a9ca2" relationship="22d3799d"/>
        <sourceConnection xsi:type="archimate:Connection" id="4aaab722" source="aefe076e" target="3609f849" relationship="2fb87559"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="0a5a9ca2" textAlignment="2" targetConnections="84d98d98" archimateElement="51c4570e">
        <bounds x="360" y="864" width="156" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="8c4fdbc6" source="0a5a9ca2" target="76055d60" relationship="f259f122"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="76055d60" textAlignment="2" targetConnections="8c4fdbc6" fillColor="#9fd580" archimateElement="3238bb02">
        <bounds x="576" y="864" width="132" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="0c49881f" source="76055d60" target="4349569f" relationship="126d1196"/>
        <sourceConnection xsi:type="archimate:Connection" id="f1328510" source="76055d60" target="73a3f6ea" relationship="9d0d4ec7"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="3609f849" textAlignment="2" targetConnections="4aaab722" archimateElement="7f30b0ad">
        <bounds x="384" y="936" width="156" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="15eaf966" source="3609f849" target="5e82b49d" relationship="c5bc7b59"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="5e82b49d" textAlignment="2" targetConnections="15eaf966" fillColor="#9fd580" archimateElement="5960c797">
        <bounds x="576" y="936" width="132" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="5b3a7fa7" source="5e82b49d" target="3e5fd50c" relationship="3f87435f"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="4cd6f56f" textAlignment="2" fillColor="#9fd580" archimateElement="df853636">
        <bounds x="468" y="642" width="132" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="e89b7619" source="4cd6f56f" target="192f55d2" relationship="8e61a519"/>
        <sourceConnection xsi:type="archimate:Connection" id="5d68b61b" source="4cd6f56f" target="90f40a81" relationship="b177fb86"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="c14c2d08" textAlignment="2" targetConnections="4160badc" fillColor="#8dc7c7" archimateElement="d046beea">
        <bounds x="24" y="132" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="f06d2aa0" source="c14c2d08" target="1e6fec85" relationship="121ffd67"/>
        <sourceConnection xsi:type="archimate:Connection" id="89b480c6" source="c14c2d08" target="6963081f" relationship="846a612a"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="6963081f" textAlignment="2" targetConnections="89b480c6 52a0bb96 f6cf0cc8 d97c5904" fillColor="#8dc7c7" archimateElement="89291244">
        <bounds x="564" y="48" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="772cd500" source="6963081f" target="2a2dc6d8" relationship="18ba669d"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="2a2dc6d8" textAlignment="2" targetConnections="9d7a204f 772cd500" fillColor="#8dc7c7" archimateElement="45fc24a1">
        <bounds x="564" y="216" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="2db68f90" source="2a2dc6d8" target="e8258cf4" relationship="6052fa43"/>
        <sourceConnection xsi:type="archimate:Connection" id="f6cf0cc8" source="2a2dc6d8" target="6963081f" relationship="f70383f8"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="192f55d2" textAlignment="2" targetConnections="e89b7619 7f216996 bed6999a 68bab231" fillColor="#8dc7c7" archimateElement="14a56e98">
        <bounds x="384" y="576" width="120" height="55"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="1e6fec85" textAlignment="2" targetConnections="f06d2aa0 fa292b05 26c6e879 560ec4e0" fillColor="#8dc7c7" archimateElement="df39801b">
        <bounds x="384" y="48" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="08fbd6ee" source="1e6fec85" target="7d8ac667" relationship="84dfd505"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="90f40a81" textAlignment="2" targetConnections="5d68b61b 9431dacd 83bca68a da57814b" fillColor="#8dc7c7" archimateElement="5e100dcd">
        <bounds x="564" y="576" width="120" height="55"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="7d8ac667" textAlignment="2" targetConnections="fdaa5ed4 08fbd6ee" fillColor="#8dc7c7" archimateElement="4c71f639">
        <bounds x="384" y="216" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="1c283398" source="7d8ac667" target="49655a8c" relationship="650c1f7e"/>
        <sourceConnection xsi:type="archimate:Connection" id="26c6e879" source="7d8ac667" target="1e6fec85" relationship="7d7f96e6"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="3e5fd50c" textAlignment="2" targetConnections="2b4b3f96 5b3a7fa7" fillColor="#8dc7c7" archimateElement="a0f4734c">
        <bounds x="24" y="960" width="120" height="55"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="49655a8c" textAlignment="2" targetConnections="940e08cd 1c283398" fillColor="#8dc7c7" archimateElement="718159d0" type="1">
        <bounds x="384" y="324" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="bed6999a" source="49655a8c" target="192f55d2" relationship="f62a0232"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="e8258cf4" textAlignment="2" targetConnections="a95ef26b 2db68f90" fillColor="#8dc7c7" archimateElement="7f01bbd5" type="1">
        <bounds x="564" y="324" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="83bca68a" source="e8258cf4" target="90f40a81" relationship="0385abfe"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="4349569f" textAlignment="2" targetConnections="0c49881f" fillColor="#8dc7c7" archimateElement="df120d4b">
        <bounds x="587" y="738" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="da57814b" source="4349569f" target="90f40a81" relationship="7285e3a5"/>
      </child>
      <child xsi:type="archimate:DiagramObject" id="73a3f6ea" textAlignment="2" targetConnections="f1328510" fillColor="#8dc7c7" archimateElement="e5e64e57">
        <bounds x="445" y="738" width="120" height="55"/>
        <sourceConnection xsi:type="archimate:Connection" id="68bab231" source="73a3f6ea" target="192f55d2" relationship="b26e1873"/>
      </child>
    </element>
  </folder>
</archimate:model>
